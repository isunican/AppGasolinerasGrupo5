Index: app/src/main/java/com/isunican/proyectobase/Views/FilterActivity.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.isunican.proyectobase.Views;\r\n\r\nimport androidx.appcompat.app.AppCompatActivity;\r\n\r\nimport com.isunican.proyectobase.DataBase.Filtro;\r\nimport com.isunican.proyectobase.DataBase.FiltroDAO;\r\n\r\nimport com.isunican.proyectobase.Model.*;\r\nimport com.isunican.proyectobase.R;\r\n\r\nimport android.app.AlertDialog;\r\nimport android.content.DialogInterface;\r\nimport android.content.Intent;\r\nimport android.os.Bundle;\r\nimport android.view.View;\r\nimport android.widget.ArrayAdapter;\r\nimport android.widget.Button;\r\nimport android.widget.CheckBox;\r\nimport android.widget.CompoundButton;\r\nimport android.widget.EditText;\r\nimport android.widget.RadioButton;\r\nimport android.widget.Spinner;\r\nimport android.widget.Switch;\r\nimport android.widget.Toast;\r\n\r\nimport java.util.ArrayList;\r\n\r\npublic class FilterActivity extends AppCompatActivity {\r\n\r\n    Button btnGuardarConfig;\r\n    Spinner spinnerMarca;\r\n    Spinner spinnerProvincia;\r\n    ArrayList<Gasolinera> gasolineras;\r\n    ArrayList<String> marcas;\r\n    ArrayList<String> provincias;\r\n\r\n    CheckBox checkDistancia;\r\n    CheckBox checkPrecio;\r\n    CheckBox checkFavoritos;\r\n\r\n    RadioButton rdistanciaMayorA;\r\n    RadioButton rdistanciaMenorA;\r\n\r\n    RadioButton rprecioMayorAMenor;\r\n    RadioButton rprecioMenorrAMayor;\r\n\r\n    EditText textNumberDistancia;\r\n\r\n    Switch switchGasoil;\r\n    Switch switchGasolina;\r\n\r\n    String nombre = \"\";\r\n\r\n    // Se crea el filtro\r\n    private FiltroDAO filtroDAO;\r\n    private Filtro filtro;\r\n\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        setContentView(R.layout.activity_filter);\r\n\r\n        spinnerMarca = findViewById(R.id.spinnerMarca);\r\n        spinnerProvincia = findViewById(R.id.spinnerProvincia);\r\n\r\n        // Filtro\r\n        filtroDAO = FiltroDAO.get(this);\r\n        filtro = getIntent().getExtras().getParcelable(\"filtro\");\r\n\r\n        switchGasoil = findViewById(R.id.switchGasoil);\r\n        switchGasolina = findViewById(R.id.switchGasolina);\r\n        // Se representa los switches acorde con el filtro correspondiente activo\r\n        if(filtro.isGasolina()){\r\n            switchGasolina.setChecked(true);\r\n        }\r\n        if(filtro.isGasoil()){\r\n            switchGasoil.setChecked(true);\r\n        }\r\n\r\n        marcas = new ArrayList<String>();\r\n        provincias = new ArrayList<String>();\r\n\r\n        gasolineras = (ArrayList<Gasolinera>) getIntent().getSerializableExtra(\"list_gasolineras\");\r\n\r\n        //La primera opción debe ser \"nada seleccionado\"\r\n        marcas.add(\"Ninguna\");\r\n        provincias.add(\"Ninguna\");\r\n\r\n        //Rellenamos las listas locales para que tengan toda la información de marcas\r\n        //y provincias.\r\n        for (Gasolinera g : gasolineras) {\r\n            if (!marcas.contains(g.getRotulo())) {\r\n                marcas.add(g.getRotulo());\r\n            }\r\n\r\n            if (!provincias.contains(g.getProvincia())) {\r\n                provincias.add(g.getProvincia());\r\n            }\r\n        }\r\n\r\n        //Construimos el adapter del spinner de manera que éste tenga de posibles opciones seleccionables todas las marcas\r\n        ArrayAdapter<CharSequence> adpMarca = new ArrayAdapter(this, android.R.layout.simple_spinner_dropdown_item, marcas);\r\n        spinnerMarca.setAdapter(adpMarca);\r\n        //Opción por defecto: ninguna marca seleccionada\r\n        spinnerMarca.setSelection(0);\r\n\r\n        /**spinnerMarca.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {\r\n        @Override public void onItemSelected(AdapterView<?> parent, View view, int position, long id) {\r\n        //  TODO Acción para cuando se seleccione una opción del spinner\r\n        }\r\n\r\n        @Override public void onNothingSelected(AdapterView<?> parent) {\r\n        //TODO Acción para cuando se seleccione una opción del spinner\r\n        }\r\n        });**/\r\n\r\n        //Construimos el adapter del spinner de manera que éste tenga de posibles opciones seleccionables todas las marcas\r\n        ArrayAdapter<CharSequence> adpProvincia = new ArrayAdapter(this, android.R.layout.simple_spinner_dropdown_item, provincias);\r\n        spinnerProvincia.setAdapter(adpProvincia);\r\n        //Opción por defecto: ninguna provincia seleccionada\r\n        spinnerProvincia.setSelection(0);\r\n\r\n        /**spinnerProvincia.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {\r\n        @Override public void onItemSelected(AdapterView<?> parent, View view, int position, long id) {\r\n        //  TODO Acción para cuando se seleccione una opción del spinner\r\n        }\r\n\r\n        @Override public void onNothingSelected(AdapterView<?> parent) {\r\n        //TODO Acción para cuando se seleccione una opción del spinner\r\n        }\r\n        });**/\r\n\r\n        //Campo de texto en el que se especifica la distancia\r\n        textNumberDistancia = findViewById(R.id.editTextDistancia);\r\n        //Botones \"mayor que\" y \"menor que\"\r\n        rdistanciaMayorA = findViewById(R.id.radioButtonMayor);\r\n        rdistanciaMenorA = findViewById(R.id.radioButtonMenor);\r\n\r\n        //Botones \"mayor a menor\" y \"menor a mayor\"\r\n        rprecioMayorAMenor = findViewById(R.id.radioButtonAsc);\r\n        rprecioMenorrAMayor = findViewById(R.id.radioButtonDesc);\r\n\r\n        //Inicialmente están desactivados, ya que no se ha especificado ningún filtro.\r\n        rdistanciaMayorA.setEnabled(false);\r\n        rdistanciaMenorA.setEnabled(false);\r\n        textNumberDistancia.setEnabled(false);\r\n\r\n        rprecioMayorAMenor.setEnabled(false);\r\n        rprecioMenorrAMayor.setEnabled(false);\r\n\r\n        //CheckBox que indica si se está filtrando por distancia\r\n        checkDistancia = findViewById(R.id.checkDistancia);\r\n        //CheckBox que indica si se está filtrando por precio\r\n        checkPrecio = findViewById(R.id.checkPrecio);\r\n        //CheckBox que indica si se está filtrando por gasolineras guardadas como favoritas\r\n        checkFavoritos = findViewById(R.id.checkFavoritos);\r\n        //TODO De momento estas funciones están desactivadas\r\n        checkFavoritos.setEnabled(false);\r\n        checkPrecio.setEnabled(false);\r\n        checkDistancia.setEnabled(false);\r\n        spinnerProvincia.setEnabled(false);\r\n        spinnerMarca.setEnabled(false);\r\n\r\n        //Si el usuario indica que quiere filtrar por distancia, se habilitan los botones\r\n        //de selección de orden y la caja de texto.\r\n        checkDistancia.setOnCheckedChangeListener(new CompoundButton.OnCheckedChangeListener() {\r\n            @Override\r\n            public void onCheckedChanged(CompoundButton buttonView, boolean isChecked) {\r\n                if (isChecked) {\r\n                    rdistanciaMayorA.setEnabled(true);\r\n                    rdistanciaMenorA.setEnabled(true);\r\n                    textNumberDistancia.setEnabled(true);\r\n                } else {\r\n                    rdistanciaMayorA.setEnabled(false);\r\n                    rdistanciaMenorA.setEnabled(false);\r\n                    textNumberDistancia.setEnabled(false);\r\n                }\r\n            }\r\n        });\r\n\r\n        //Si el usuario indica que quiere ordenar por precio, se habilitan los botones\r\n        //de selección de orden.\r\n        checkPrecio.setOnCheckedChangeListener(new CompoundButton.OnCheckedChangeListener() {\r\n            @Override\r\n            public void onCheckedChanged(CompoundButton buttonView, boolean isChecked) {\r\n                if (isChecked) {\r\n                    rprecioMayorAMenor.setEnabled(true);\r\n                    rprecioMenorrAMayor.setEnabled(true);\r\n                } else {\r\n                    rprecioMayorAMenor.setEnabled(false);\r\n                    rprecioMenorrAMayor.setEnabled(false);\r\n                }\r\n            }\r\n        });\r\n\r\n        btnGuardarConfig = findViewById(R.id.btnGuardarConfig);\r\n        btnGuardarConfig.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                createConfirmationDialog();\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Se activa onClick() cuando se presiona el boton de Aceptar. Se pasa la configuracion de\r\n     * filtro seleccionada al view correspondiente(MainActivity).\r\n     * Y se cierra esta activity(FilterActivity).\r\n     */\r\n    public void aceptarFiltros() {\r\n        Filtro filtroSeleccionado = new Filtro(nombre, switchGasoil.isChecked(), switchGasolina.isChecked());\r\n        Intent intent = new Intent().putExtra(\"filtro\", filtroSeleccionado);\r\n        setResult(RESULT_OK, intent);\r\n        finish();\r\n    }\r\n\r\n    public void createConfirmationDialog() {\r\n        //Este AlertDialog será el que guarde el nombre que el usuario quiera darle a su configuración de filtros\r\n        AlertDialog.Builder builder = new AlertDialog.Builder(this);\r\n        builder.setMessage(\"Introduzca nombre para su configuración\");\r\n        builder.setTitle(\"Nombre de la configuración\");\r\n        final EditText nombreConfiguracion = new EditText(FilterActivity.this);\r\n        builder.setView(nombreConfiguracion);\r\n        builder.setPositiveButton(\"Sí\", new DialogInterface.OnClickListener() {\r\n            @Override\r\n            public void onClick(DialogInterface dialog, int which) {\r\n                nombre = nombreConfiguracion.getText().toString();\r\n                Toast toast;\r\n                if (nombre.isEmpty()) {\r\n                    toast = Toast.makeText(getApplicationContext(), \"Introduzca un nombre\", Toast.LENGTH_LONG);\r\n                } else {\r\n                    // Añade nueva configuración de filtro a la base de datos de filtros\r\n                    filtro.setNombre(nombre);\r\n                    filtro.setGasoil(switchGasoil.isChecked());\r\n                    filtro.setGasolina(switchGasolina.isChecked());\r\n                    filtroDAO.addFiltro(filtro);\r\n                    toast = Toast.makeText(getApplicationContext(), \"Configuración guardada\", Toast.LENGTH_LONG);\r\n                }\r\n                toast.show();\r\n            }\r\n            });\r\n\r\n        builder.setNegativeButton(\"No\", new DialogInterface.OnClickListener() {\r\n            @Override\r\n            public void onClick(DialogInterface dialog, int which) {}\r\n        });\r\n        AlertDialog confirmation = builder.create();\r\n        confirmation.show();\r\n    }\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/java/com/isunican/proyectobase/Views/FilterActivity.java	(revision cce5fe241f62d0306af14ef98ef7a17868afd0a2)
+++ app/src/main/java/com/isunican/proyectobase/Views/FilterActivity.java	(date 1604536782041)
@@ -1,13 +1,5 @@
 package com.isunican.proyectobase.Views;
 
-import androidx.appcompat.app.AppCompatActivity;
-
-import com.isunican.proyectobase.DataBase.Filtro;
-import com.isunican.proyectobase.DataBase.FiltroDAO;
-
-import com.isunican.proyectobase.Model.*;
-import com.isunican.proyectobase.R;
-
 import android.app.AlertDialog;
 import android.content.DialogInterface;
 import android.content.Intent;
@@ -23,11 +15,19 @@
 import android.widget.Switch;
 import android.widget.Toast;
 
+import androidx.appcompat.app.AppCompatActivity;
+
+import com.isunican.proyectobase.DataBase.Filtro;
+import com.isunican.proyectobase.DataBase.FiltroDAO;
+import com.isunican.proyectobase.Model.Gasolinera;
+import com.isunican.proyectobase.R;
+
 import java.util.ArrayList;
 
 public class FilterActivity extends AppCompatActivity {
 
     Button btnGuardarConfig;
+    Button btnAplicarFiltros;
     Spinner spinnerMarca;
     Spinner spinnerProvincia;
     ArrayList<Gasolinera> gasolineras;
@@ -200,6 +200,14 @@
                 createConfirmationDialog();
             }
         });
+
+        btnAplicarFiltros= findViewById(R.id.btnAceptar);
+        btnAplicarFiltros.setOnClickListener(new View.OnClickListener() {
+            @Override
+            public void onClick(View v) {
+                aceptarFiltros();
+            }
+        });
     }
 
     /**
Index: app/src/androidTest/java/com/isunican/proyectobase/GuardarConfiguracionFiltrosUITest.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.isunican.proyectobase;\r\n\r\nimport android.content.Context;\r\n\r\nimport androidx.test.filters.LargeTest;\r\nimport androidx.test.platform.app.InstrumentationRegistry;\r\nimport androidx.test.ext.junit.runners.AndroidJUnit4;\r\nimport androidx.test.rule.ActivityTestRule;\r\n\r\nimport com.isunican.proyectobase.Views.MainActivity;\r\n\r\nimport org.junit.Rule;\r\nimport org.junit.Test;\r\nimport org.junit.runner.RunWith;\r\n\r\nimport static androidx.test.espresso.Espresso.onData;\r\nimport static androidx.test.espresso.Espresso.onView;\r\nimport static androidx.test.espresso.action.ViewActions.click;\r\nimport static androidx.test.espresso.action.ViewActions.closeSoftKeyboard;\r\nimport static androidx.test.espresso.action.ViewActions.typeText;\r\nimport static androidx.test.espresso.assertion.ViewAssertions.matches;\r\nimport static androidx.test.espresso.matcher.ViewMatchers.withId;\r\nimport static androidx.test.espresso.matcher.ViewMatchers.withText;\r\nimport static org.hamcrest.Matchers.allOf;\r\nimport static org.hamcrest.Matchers.instanceOf;\r\nimport static org.hamcrest.Matchers.is;\r\nimport static org.junit.Assert.*;\r\n\r\n/**\r\n * Instrumented test, which will execute on an Android device.\r\n *\r\n * @see <a href=\"http://d.android.com/tools/testing\">Testing documentation</a>\r\n */\r\n@RunWith(AndroidJUnit4.class)\r\n@LargeTest\r\npublic class GuardarConfiguracionFiltrosUITest {\r\n\r\n    @Rule\r\n    public ActivityTestRule<MainActivity> activityRule\r\n            = new ActivityTestRule<>(MainActivity.class);\r\n    @Test\r\n    public void useAppContext() {\r\n        // Context of the app under test.\r\n        Context appContext = InstrumentationRegistry.getInstrumentation().getTargetContext();\r\n\r\n        assertEquals(\"com.isunican.proyectobase\", appContext.getPackageName());\r\n    }\r\n\r\n    @Test\r\n    public void guardaConfiguracionTest (){\r\n\r\n        //Selección del boton lista filtros para mostrar la lista de filtros\r\n        onView(withId(R.id.btnListaFiltros)).check(matches(withText(\"MOSTRAR FILTROS\")));\r\n        onView(withId(R.id.btnListaFiltros)).perform(click());\r\n        //Posible Selección de filtros\r\n        onView(withId(R.id.btnGuardarConfig)).check(matches(withText(\"GUARDAR CONFIGURACIÓN DE FILTROS\")));\r\n        onView(withId(R.id.switchGasoil)).perform(click());\r\n        onView(withId(R.id.spinnerProvincia)).perform(click());\r\n        onData(allOf(is(instanceOf(String.class)), is(\"CANTABRIA\"))).perform(click());\r\n        onView(withId(R.id.spinnerMarca)).perform(click());\r\n        onData(allOf(is(instanceOf(String.class)), is(\"CEPSA\"))).perform(click());\r\n        onView(withId(R.id.checkDistancia)).perform(click());\r\n        onView(withId(R.id.radioButtonMenor)).perform(click());\r\n        onView(withId(R.id.editTextDistancia)).perform(typeText(\"100\"), closeSoftKeyboard());\r\n        onView(withId(R.id.checkPrecio)).perform(click());\r\n        onView(withId(R.id.radioButtonAsc)).perform(click());\r\n        //Guardar selección de filtros con nombre\r\n        onView(withId(R.id.btnGuardarConfig)).perform(click());\r\n\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/androidTest/java/com/isunican/proyectobase/GuardarConfiguracionFiltrosUITest.java	(revision cce5fe241f62d0306af14ef98ef7a17868afd0a2)
+++ app/src/androidTest/java/com/isunican/proyectobase/GuardarConfiguracionFiltrosUITest.java	(date 1604537185557)
@@ -53,7 +53,7 @@
         onView(withId(R.id.btnListaFiltros)).check(matches(withText("MOSTRAR FILTROS")));
         onView(withId(R.id.btnListaFiltros)).perform(click());
         //Posible Selección de filtros
-        onView(withId(R.id.btnGuardarConfig)).check(matches(withText("GUARDAR CONFIGURACIÓN DE FILTROS")));
+        onView(withId(R.id.btnGuardarConfig)).check(matches(withText("GUARDAR CONFIGURACIÓN")));
         onView(withId(R.id.switchGasoil)).perform(click());
         onView(withId(R.id.spinnerProvincia)).perform(click());
         onData(allOf(is(instanceOf(String.class)), is("CANTABRIA"))).perform(click());
